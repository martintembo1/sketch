

class Sessions {


constructor(defs) {
this.save = defs.save ? defs.save: false;
this.expires = defs.expires ? defs.expires : 7;
this.isJSON = defs.json;
this.app = "Moult.sesssions";
}

async call(req,res,app) {
if(req.cookies.session) {
let sessions;
try {
sessions =app.uid.decypher(req.cookies.session);
req.session = this.isJSON ? JSON.parse(sessions) : sessions;
} catch(e) {  }
}

res.session = session => {
session = this.isJSON ? JSON.stringify(session) : session;
session = app.uid.cypher(session);
res.cookie("session", session, this.expires);
}

return "sessions";

}

}

module.exports = Sessions;